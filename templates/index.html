<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Future Makers Interview Assistant</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <style>
      #InterviewSummary,
      #assesment,
      #userResponses {
        display: none;
      }

      #output {
        margin-top: 20px;
      }

      #app {
        margin-left: 10px;
        margin-right: 10px;
      }

      input,
      select {
        width: 60%;
      }

      .pointer {
        cursor: pointer;
      }

      .plan h1 {
        text-align: center;
        color: #0066cc;
      }

      .plan h2 {
        color: #00509e;
        margin-top: 20px;
      }

      .dynamic-text {
        background-color: #eaf4ff;
        padding: 10px;
        border-radius: 5px;
        color: #003366;
        font-weight: bold;
      }

      .materials {
        background-color: #dfffd6;
        padding: 10px;
        border-radius: 5px;
        color: #005f00;
      }

      .steps {
        background-color: #fff3d6;
        padding: 10px;
        border-radius: 5px;
        color: #805300;
      }
    </style>
  </head>

  <body>
    <div id="app">
      <div>
        <div class="d-flex justify-content-between align-items-center">
          <h1 class="my-4">Future Makers Interview Assistant</h1>
          <div class="d-flex">
            <button
              class="btn btn-primary mr-2"
              onclick="showSection('InterviewSummary')"
            >
              Interview Summary
            </button>
            <button class="btn btn-primary" onclick="showSection('assesment')">
              Assessment Questions
            </button>
          </div>
        </div>

        <h4>
          This project will prepare a lesson plan for making FutureMakers Spark,
          the flying machines that are tailored to the target grade of the
          learners. Also, assessment questions will be generated for the
          learners to evaluate their understanding of the subject matter.
        </h4>
      </div>

      <div class="d-flex">
        <!-- Questions Section -->
        <form id="questions-form">
          <div id="questions" class="mr-5">
            <p>Please answer the following questions:</p>
            <label for="Q1"
              >How much time do you have for this activity? (in minutes)</label
            >
            <input type="text" id="Q1" class="form-control my-2" />

            <label for="Q2"
              >What grade(s) or age group(s) are your learners?</label
            >
            <select name="school_class" id="Q2" class="form-control my-2">
              <option value="kindergarten">Kindergarten (Age: 5-6)</option>
              <option value="elementary">Elementary School (Age: 6-11)</option>
              <option value="middle_school">Middle School (Age: 11-14)</option>
            </select>

            <label for="Q3"
              >What is the learning environment (e.g., classroom, library,
              after-school)?</label
            >
            <input type="text" id="Q3" class="form-control my-2" />

            <label for="Q4"
              >How confident are you in using hands-on projects?</label
            >
            <input
              type="range"
              id="Q4"
              name="rating"
              min="1"
              max="5"
              value="3"
              step="1"
              class="form-control my-2"
              oninput="this.nextElementSibling.value = this.value"
            />
            <output class="my-2">3</output>
            <br />

            <label for="Q5">Do you want to include an assessment? </label>
            <select name="assessment" id="Q5" class="form-control my-2">
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select>

            <label for="Q6"
              >Do you want to teach learners the science of flight while
              building the model?</label
            >
            <select name="teach_science" id="Q6" class="form-control my-2">
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select>

            <label for="Q7"
              >Do you want the learners to collaborate in groups for the
              extension project?</label
            >
            <input type="text" id="Q7" class="form-control my-2" />

            <button type="submit" class="btn btn-success mt-3">
              Create Lesson Plan
            </button>
          </div>
        </form>
        <!-- Interview Summary Section -->
        <div id="InterviewSummary">
          <h2>Interview Summary</h2>
          <div id="UsersResponse">
            <p>Users Response:</p>
            <ul id="userResponses">
              <li id="Q1Response"></li>
              <li id="Q2Response"></li>
              <li id="Q3Response"></li>
              <li id="Q4Response"></li>
              <li id="Q5Response"></li>
              <li id="Q6Response"></li>
              <li id="Q7Response"></li>
            </ul>
          </div>
          <div id="AI Response">
            <p>AI Response:</p>
            <p class="loading">Loading...</p>
            <div id="AIResponseText"></div>
          </div>
        </div>

        <!-- Assessment Section -->
        <div id="assesment">
        </div>
      </div>

      <!-- Lesson Plan Section -->
      <div id="LessonPlan">
      </div>
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
      const submitButton = document.getElementById("submit");
      const outputList = document.getElementById("output");

      function showSection(sectionId) {
        // Hide all sections
        const sections = ["InterviewSummary", "assesment"];
        sections.forEach((section) => {
          document.getElementById(section).style.display = "none";
        });

        // Show the requested section
        document.getElementById(sectionId).style.display = "block";
      }

      // Show the Interview Summary section by default
      showSection("InterviewSummary");

      document
        .getElementById("questions-form")
        .addEventListener("submit", async function (event) {
          event.preventDefault(); // Prevent the form from refreshing the page

          // Get the input values
          const Q1 = document.getElementById("Q1").value;
          const Q2 = document.getElementById("Q2").value;
          const Q3 = document.getElementById("Q3").value;
          const Q4 = document.getElementById("Q4").value;
          const Q5 = document.getElementById("Q5").value;
          const Q6 = document.getElementById("Q6").value;
          const Q7 = document.getElementById("Q7").value;

          // Display the responses in the respective <p> tags
          document.getElementById(
            "Q1Response"
          ).textContent = `User wants to spend ${Q1} minutes on this activity.`;
          document.getElementById(
            "Q2Response"
          ).textContent = `Learners belong to ${Q2} grade`;
          document.getElementById(
            "Q3Response"
          ).textContent = `Learning environment is specified as: ${Q3}.`;
          document.getElementById(
            "Q4Response"
          ).textContent = `Confidence level in hands-on projects is: ${Q4} out of 5.`;
          document.getElementById(
            "Q5Response"
          ).textContent = `Assessment preference: ${Q5}.`;
          document.getElementById(
            "Q6Response"
          ).textContent = `Interest in teaching science of flight: ${Q6}.`;
          document.getElementById(
            "Q7Response"
          ).textContent = `Group collaboration preference: ${Q7}.`;
          document.getElementById("userResponses").style.display = "block";

          // Prepare the data to send to the API
          const interviewAnswers = {
            Q1,
            Q2,
            Q3,
            Q4,
            Q5,
            Q6,
            Q7,
          };

          try {
            // Make the API call
            const response = await fetch(
              "https://karthikvibuthiportfolio.com/futuremakers/lesson-plan",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({ "interview-answers": interviewAnswers }),
              }
            );

            // Parse and handle the response
            if (response.ok) {
              const result = await response.json();
              console.log("API Response:", result);
              document.getElementById("LessonPlan").textContent = result;
              outputList.textContent = `API Response: ${JSON.stringify(
                result
              )}`;
            } else {
              console.error("Error from API:", response.statusText);
              outputList.textContent = `Error from API: ${response.statusText}`;
            }
          } catch (error) {
            console.error("API Call Failed:", error);
            outputList.textContent = `API Call Failed: ${error.message}`;
          }
        });
    </script>
  </body>
</html>
